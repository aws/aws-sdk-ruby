{"version":"1.1","parameters":{"Region":{"builtIn":"AWS::Region","required":true,"type":"String"},"UseDualStack":{"builtIn":"AWS::UseDualStack","required":true,"default":false,"type":"Boolean"},"UseFIPS":{"builtIn":"AWS::UseFIPS","required":true,"default":false,"type":"Boolean"}},"rules":[{"conditions":[{"fn":"aws.partition","argv":[{"ref":"Region"}],"assign":"PartitionResult"}],"type":"tree","rules":[{"conditions":[{"fn":"booleanEquals","argv":[{"ref":"UseFIPS"},true]},{"fn":"booleanEquals","argv":[{"ref":"UseDualStack"},true]}],"type":"tree","rules":[{"conditions":[{"fn":"booleanEquals","argv":[true,{"fn":"getAttr","argv":[{"ref":"PartitionResult"},"supportsFIPS"]}]},{"fn":"booleanEquals","argv":[true,{"fn":"getAttr","argv":[{"ref":"PartitionResult"},"supportsDualStack"]}]}],"type":"tree","rules":[{"conditions":[],"endpoint":{"url":"https://ec2-fips.{Region}.{PartitionResult#dualStackDnsSuffix}","properties":{"authSchemes":[{"signingName":"ec2","name":"sigv4","signingRegion":"{Region}"}]},"headers":{}},"type":"endpoint"}]},{"conditions":[],"error":"FIPS and DualStack are enabled, but this partition does not support one or both","type":"error"}]},{"conditions":[{"fn":"booleanEquals","argv":[{"ref":"UseFIPS"},true]}],"type":"tree","rules":[{"conditions":[{"fn":"booleanEquals","argv":[true,{"fn":"getAttr","argv":[{"ref":"PartitionResult"},"supportsFIPS"]}]}],"type":"tree","rules":[{"conditions":[],"type":"tree","rules":[{"conditions":[{"fn":"stringEquals","argv":["aws-us-gov",{"fn":"getAttr","argv":[{"ref":"PartitionResult"},"name"]}]}],"endpoint":{"url":"https://ec2.{Region}.{PartitionResult#dnsSuffix}","properties":{"authSchemes":[{"signingName":"ec2","name":"sigv4","signingRegion":"{Region}"}]},"headers":{}},"type":"endpoint"},{"conditions":[],"endpoint":{"url":"https://ec2-fips.{Region}.{PartitionResult#dnsSuffix}","properties":{"authSchemes":[{"signingName":"ec2","name":"sigv4","signingRegion":"{Region}"}]},"headers":{}},"type":"endpoint"}]}]},{"conditions":[],"error":"FIPS is enabled but this partition does not support FIPS","type":"error"}]},{"conditions":[{"fn":"booleanEquals","argv":[{"ref":"UseDualStack"},true]}],"type":"tree","rules":[{"conditions":[{"fn":"booleanEquals","argv":[true,{"fn":"getAttr","argv":[{"ref":"PartitionResult"},"supportsDualStack"]}]}],"type":"tree","rules":[{"conditions":[],"endpoint":{"url":"https://ec2.{Region}.{PartitionResult#dualStackDnsSuffix}","properties":{"authSchemes":[{"signingName":"ec2","name":"sigv4","signingRegion":"{Region}"}]},"headers":{}},"type":"endpoint"}]},{"conditions":[],"error":"DualStack is enabled but this partition does not support DualStack","type":"error"}]},{"conditions":[],"endpoint":{"url":"https://ec2.{Region}.{PartitionResult#dnsSuffix}","properties":{"authSchemes":[{"signingName":"ec2","name":"sigv4","signingRegion":"{Region}"}]},"headers":{}},"type":"endpoint"}]}]}